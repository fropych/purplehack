# 1 –º–µ—Å—Ç–æ ü•á IT Purple Hack - Alpha Bank üè¶üìàüôãüèª‚Äç‚ôÇÔ∏è
## Team: MISIS FOUND HACK
## –ú–æ–¥–µ–ª—å –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞ –∫–ª–∏–µ–Ω—Ç–∞

![](assets/arch.jpeg)

### –°—Å—ã–ª–∫–∏
* [blend submissions](https://drive.google.com/drive/folders/1VvkqH99kXWkUAxdBELfCksp8SyzMfHVC) - –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π –≤ CSV, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –±–ª–µ–Ω–¥–µ 
* [data](https://drive.google.com/drive/u/0/folders/1yK1Q_FYScMvICZnF-ji1QdeLOvQdzkf8) - —Å—ã—Ä—ã–µ –∏ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π
* [Autoencoder Embeddings](https://disk.yandex.ru/d/-_FoTikiwEOV9A) - —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Å –ø–æ–º–æ—â—å—é –∞–≤—Ç–æ—ç–Ω–∫–æ–¥–µ—Ä–∞

1) ```make_test_filled.ipynb```
1) –í ```knn_and_mlp.ipynb``` –≤ –Ω–∞—á–∞–ª–µ –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —è—á–µ–π–∫–∏ —Å —Å–æ–∑–¥–∞–Ω–∏–µ–º ```train_ae_v``` –∏ ```test_ae_v```
2) ```python  dae/train.py```
3) –î–∞–ª—å—à–µ –∑–∞–ø—É—Å–∫–∞—Ç—å —è—á–µ–π–∫–∏ –≤ ```knn_and_mlp.ipynb```
4) –ù–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∞–µ–º 
    - ```train_cluster_kmeans12.pqt```
    - ```test_cluster_kmeans12.pqt```
    - ```mlp_submission.csv```
5) –î–∞–ª–µ–µ –ø–æ–¥–∞–µ–º –ø–æ–ª—É—á–∏–≤—à–∏–µ—Å—è –ø–∞—Ä–∫–µ—Ç—ã –≤ ```vanya.ipynb```
6) ```kfold_auto_blend.ipynb```
7) ```smote.ipynb```
8) ```blend.ipynb```  
   
```–í—Å–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –µ—Å—Ç—å –≤ —Å—Å—ã–ª–∫–∞—Ö```

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

1. –ò–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–æ–π –∫–ª–∏–µ–Ω—Ç–∞, –≤–ª–∏—è—é—â–µ–π
–Ω–∞ –µ–≥–æ –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å, —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤—ã–π –∫–ª–∞—Å—Ç–µ—Ä. –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –ø–µ—Ä–µ—Ö–æ–¥ –∫–ª–∏–µ–Ω—Ç–∞ –≤ –¥—Ä—É–≥–æ–π –ø—Ä–æ–¥—É–∫—Ç–æ–≤—ã–π –∫–ª–∞—Å—Ç–µ—Ä –ø–æ–∑–≤–æ–ª–∏—Ç —Å–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—å –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏.

2. –ú—ã –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–¥—É–∫—Ç–æ–≤—ã–π –∫–ª–∞—Å—Ç–µ—Ä –∫–ª–∏–µ–Ω—Ç–∞ –Ω–∞ –≥–æ–¥ –≤–ø–µ—Ä–µ–¥ –∏ –¥–µ–ª–∞–µ–º —ç—Ç–æ –Ω–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç—Ç–∞–ø–æ–≤:
    * Feature Engineering
      - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ª–∞–≥–æ–≤
      - OneHot –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ —Å—Ç–∞—Ä—Ç–æ–≤–æ–º –ø—Ä–æ–¥—É–∫—Ç–æ–≤–æ–º –∫–ª–∞—Å—Ç–µ—Ä–µ –∫–ª–∏–µ–Ω—Ç–∞
      - –û–±—É—á–µ–Ω–∏–µ –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤–æ–π –º–æ–¥–µ–ª–∏ AutoEncoder –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –ø–æ–ª—É—á–µ–Ω–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤, –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ —ç—Ç–∏–º —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º (—Ç–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º —ç—Ç–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏–Ω—Å–∞–π—Ç–æ–≤). –î–∞–ª–µ–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º —ç—Ç–∏ –∫–ª–∞—Å—Ç–µ—Ä—ã –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø—Ä–∏ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ç–∞—Ä–≥–µ—Ç–∞
      - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø—É—Ç–µ–º –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —á–∏—Å–ª–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–º
      - –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (–∫–æ–ª–æ–Ω–∫–∏ –Ω–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –∑–∞–ø–æ–ª–Ω—è–µ–º –Ω—É–ª—è–º–∏ –∏ –ø—Ä–∏ –ø–æ–º–æ—â–∏ KNNImputer. –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è start_cluster –≤ —Ç–µ—Å—Ç–æ–≤–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ —Å –¥–∞—Ç–æ–π month_6 –∑–∞–ø–æ–ª–Ω—è–µ–º –ø—Ä–∏ –ø–æ–º–æ—â–∏ –º–æ–¥–µ–ª–∏ CatBoost)
      - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–µ–¥–∫–∏—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ (–±–æ—Ä—å–±–∞ —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º –∫–ª–∞—Å—Å–æ–≤) –ø—Ä–∏ –ø–æ–º–æ—â–∏ SMOTE
    * –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
        - –û–±—É—á–µ–Ω–∏–µ –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω–æ–≥–æ –ø–µ—Ä—Å–µ–ø—Ç—Ä–æ–Ω–∞ –Ω–∞ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞—Ö –∏–∑ –∞–≤—Ç–æ—ç–Ω–∫–æ–¥–µ—Ä–∞ (—Å–º—é –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –≤ FeatureEngineering –ø. —Å)
        - –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π Catboost (–Ω–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –Ω–∞–ø—Ä–∏–º–µ—Ä —Å —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏ –±–µ–∑) –Ω–∞ —Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ —Ç–∞—Ä–≥–µ—Ç—É —Ñ–æ–ª–¥–∞—Ö
        - –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π Catboost (–Ω–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –Ω–∞–ø—Ä–∏–º–µ—Ä —Å —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏ –±–µ–∑) –Ω–∞ —á–∞—Å—Ç–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞ –∏ –∏—Ö –æ—Ü–µ–Ω–∫–∞ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ (15% –æ—Ç –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞)
    * –ê–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ 
        - –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—é –±–ª–µ–Ω–¥–∏–Ω–≥–∞ –∏ —É—Å—Ä–µ–¥–Ω—è–µ–º –ø—Ä–æ–≥–Ω–æ–∑—ã –º–æ–¥–µ–ª–µ–π, –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –≤ —Ä–∞–∑–¥–µ–ª–µ "–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π", –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —É—Å—Ç–æ–π—á–∏–≤–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∏ –ø–æ–Ω–∏–∂–µ–Ω–∏—è –¥–∏—Å–ø–µ—Ä—Å–∏–∏

3. –ß—Ç–æ –Ω–µ –ø–æ–º–æ–≥–ª–æ –∏–∑ —Ç–æ–≥–æ, —á—Ç–æ –º—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏:
    - –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∫–ª–∏–µ–Ω—Ç–∞ (–∞ –Ω–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤) –∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≤ –ø—Ä–æ–¥—É–∫—Ç–æ–≤—ã–π –∫–ª–∞—Å—Ç–µ—Ä
    - –û—Ç–¥–µ–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–Ω–∏–µ —Ä–µ–¥–∫–∏—Ö –∫–ª–∞—Å—Å–æ–≤
    - –û—Ç–¥–µ–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫–ª–∏–µ–Ω—Ç–∞ –≤ –¥—Ä—É–≥–æ–π –ø—Ä–æ–¥—É–∫—Ç–æ–≤—ã–π –∫–ª–∞—Å—Ç–µ—Ä (1 - –ø–µ—Ä–µ—à–µ–ª, 0 - –Ω–µ –ø–µ—Ä–µ—à–µ–ª)
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –≤–µ—Å–æ–≤
        - –ù–∞ —Å–µ–º–ø–ª—ã –∏–∑ —Ä–µ–¥–∫–∏—Ö –∫–ª–∞—Å—Å–æ–≤
        - –ù–∞ —Å–µ–º–ø–ª—ã, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –∫–æ–Ω–µ—á–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç–æ–≤—ã–π –∫–ª–∞—Å—Ç–µ—Ä –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ 
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π (LightGBM, LogRegression...)
    - –ü–æ–¥–±–æ—Ä –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (Optuna)
    - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ç–∞—Å—Ç–∏—á–µ—Å–∫–∏—Ö –∏ –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç —Å–µ–º–ø–ª–∞ –¥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ —Å–µ–º–ø–ª–∞ –¥–æ –ø—Ä—è–º–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏...)
    - –°—Ç–µ–∫–∏–Ω–≥ –º–æ–¥–µ–ª–µ–π (—Ä–∞–∑–±–∏–µ–Ω–∏–µ —Ç—Ä–µ–π–Ω –¥–∞—Ç–∞—Å–µ—Ç–∞ –Ω–∞ —Ç—Ä–µ–π–Ω1, —Ç—Ä–µ–π–Ω2 –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é, –Ω–∞ —Ç—Ä–µ–π–Ω–µ1 –æ–±—É—á–∞–µ–º –≤—Å–µ –º–æ–¥–µ–ª–∏, –ø–æ–ª—É—á–∞–µ–º –∏—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ —Ç—Ä–µ–π–Ω2, –æ–±—É—á–∞–µ–º –Ω–∞ —ç—Ç–∏—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è—Ö –Ω–æ–≤—É—é –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç—É—é –º–æ–¥–µ–ª—å –∏ –æ—Ü–µ–Ω–∏–≤–∞–µ–º –µ—ë –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏)
